// Generated by CoffeeScript 1.9.3
(function() {
  var JavaScriptInstrumenter, falafel;

  falafel = require("falafel");

  JavaScriptInstrumenter = (function() {
    function JavaScriptInstrumenter() {}

    JavaScriptInstrumenter.prototype.instrument = function(filename, code, options) {
      var ref, result, traceFunc;
      if (options == null) {
        options = {};
      }
      traceFunc = (ref = options.traceFunc) != null ? ref : "pencilTrace";
      result = falafel(code, {
        locations: true
      }, function(node) {
        if (node.type === 'CallExpression') {
          return node.update(traceFunc + "({location: {first_line: " + node.loc.start.line + ", first_column: " + node.loc.start.column + ", last_line: " + node.loc.end.line + ", last_column: " + node.loc.end.column + "}, type: ''})," + (node.source()));
        }
      });
      return result;
    };

    return JavaScriptInstrumenter;

  })();

  exports.instrumentJs = function(filename, code, options) {
    var instrumenter;
    if (options == null) {
      options = {};
    }
    instrumenter = new JavaScriptInstrumenter();
    return instrumenter.instrument(filename, code, options);
  };

}).call(this);
